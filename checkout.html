<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Checkout — La Dosha Hotel</title>
  <link rel="stylesheet" href="css/style.css"/>
  <style>
    .form-group { margin-bottom: 15px; }
    .order-summary { margin: 20px 0; border: 1px solid #ddd; padding: 15px; border-radius: 8px; }
    .order-item { display: flex; align-items: center; margin-bottom: 10px; }
    .order-item img { width: 60px; height: 60px; object-fit: cover; margin-right: 10px; border-radius: 6px; }
    .btn { padding: 10px 18px; border: none; border-radius: 6px; cursor: pointer; }
    .btn.primary { background: #ff8800; color: #fff; }
    .btn.secondary { background: #444; color: #fff; }
    .logo img { height: 40px; vertical-align: middle; }
  </style>
</head>
<body>
<header class="site-header">
  <div class="container header-inner">
    <div class="logo">
      <img src="assets/images/ladoshalogo.png" alt="La Dosha Hotel Logo"/> 
      La Dosha Hotel
    </div>
    <nav class="main-nav">
      <a href="index.html">Home</a>
      <a href="menu.html">Menu</a>
      <a href="cart.html">Cart (<span id="cart-count">0</span>)</a>
    </nav>
  </div>
</header>

<main class="container">
  <h1>Checkout</h1>

  <!-- Order Summary -->
  <div id="order-summary" class="order-summary"></div>

  <!-- Checkout Form -->
  <form id="checkout-form">
    <div class="form-group">
      <label>Full Name<br/>
        <input required type="text" id="cust-name"/>
      </label>
    </div>
    <div class="form-group">
      <label>Phone Number<br/>
        <input required type="tel" id="cust-phone"/>
      </label>
    </div>
    <div class="form-group">
      <label>Delivery Location<br/>
        <select id="cust-location" class="location-select" required>
          <option value="">-- Select Location --</option>
          <option>Kinamba, Naivasha</option>
          <option>Naivasha Town</option>
          <option>Moi South Lake Road</option>
        </select>
      </label>
    </div>
    <div class="form-group">
      <label>How many people?<br/>
        <input type="number" id="cust-people" min="1" value="1" class="people-select"/>
      </label>
    </div>

    <h3>Payment Method</h3>
    <div class="form-group">
      <label><input type="radio" name="payment" value="cod" checked/> Cash on Delivery</label><br/>
      <label><input type="radio" name="payment" value="mpesa"/> M-Pesa (Demo)</label><br/>
      <label><input type="radio" name="payment" value="card"/> Card (Demo)</label>
    </div>

    <button id="checkout-btn" class="btn primary" type="submit">Order Now</button>
  </form>

  <div id="checkout-result" style="margin-top:20px"></div>
</main>

<footer class="footer">
  <div class="container">&copy; 2025 La Dosha Hotel</div>
</footer>

<script src="js/cart.js"></script>
<script>
  const summaryDiv = document.getElementById('order-summary');
  const checkoutBtn = document.getElementById('checkout-btn');

  // Show order summary with images
  function renderSummary() {
    const items = getCartItems();
    if (items.length === 0) {
      summaryDiv.innerHTML = "<p>Your cart is empty.</p>";
      return;
    }
    let html = "<h3>Your Order</h3>";
    items.forEach(item => {
      html += `
        <div class="order-item">
          <img src="${item.img}" alt="${item.name}"/>
          <div>
            <strong>${item.name}</strong><br/>
            Qty: ${item.qty} × KES ${item.price} = <strong>KES ${item.qty * item.price}</strong>
          </div>
        </div>`;
    });
    html += `<p><strong>Total: KES ${getCartTotal()}</strong></p>`;
    summaryDiv.innerHTML = html;
  }
  renderSummary();
  updateCounts();

  // Change button text based on payment type
  document.querySelectorAll('input[name="payment"]').forEach(radio => {
    radio.addEventListener('change', () => {
      if (radio.value === "cod") {
        checkoutBtn.textContent = "Order Now";
      } else {
        checkoutBtn.textContent = "Checkout & Pay";
      }
    });
  });

  // Handle checkout
  document.getElementById('checkout-form').addEventListener('submit', function(e){
    e.preventDefault();

    const name = document.getElementById('cust-name').value.trim();
    const phone = document.getElementById('cust-phone').value.trim();
    const location = document.getElementById('cust-location').value;
    const people = Number(document.getElementById('cust-people').value) || 1;
    const payment = document.querySelector('input[name="payment"]:checked').value;

    if (!name || !phone || !location) {
      alert("Please fill in all required fields.");
      return;
    }

    const order = {
      customer: { name, phone, location, people },
      payment,
      items: getCartItems(),
      total: getCartTotal()
    };

    document.getElementById('checkout-result').innerHTML = `
      <div class="card">
        <h3>Thank you, ${order.customer.name}!</h3>
        <p>Your order total is <strong>KES ${order.total}</strong>.</p>
        <p>Payment Method: <strong>${payment.toUpperCase()}</strong></p>
        <p>We will contact you at <strong>${phone}</strong> for delivery to <strong>${location}</strong>.</p>
      </div>
    `;

    clearCart();
    renderSummary();
    updateCounts();
  });
</script>
</body>
</html>
