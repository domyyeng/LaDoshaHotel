<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Checkout â€” La Dosha Hotel</title>
  <link rel="stylesheet" href="css/style.css"/>
  <link rel="icon" type="image/png" href="assets/images/ladoshalogo.png" />
  <meta name="theme-color" content="#ff8800">

  <style>
    body { margin:0; font-family:sans-serif; background:#fafafa; padding-top:90px; }
    a { text-decoration:none; color:inherit; }

    /* Header */
    .site-header { position:fixed; top:0; width:100%; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,0.1); z-index:1000; }
    .site-header .container { display:flex; justify-content:space-between; align-items:center; padding:12px 20px; }
    .logo img { height:50px; }
    .main-nav { display:flex; gap:20px; }
    .main-nav a { font-weight:500; color:#333; }
    .menu-toggle { display:none; flex-direction:column; gap:5px; background:none; border:none; cursor:pointer; }
    .menu-toggle span { width:25px; height:3px; background:#333; border-radius:2px; }
    @media(max-width:768px){
      .main-nav { display:none; flex-direction:column; position:absolute; top:60px; right:20px; background:#fff; padding:15px 20px; border-radius:10px; box-shadow:0 6px 20px rgba(0,0,0,0.15); }
      .main-nav.active { display:flex; }
      .menu-toggle { display:flex; }
    }

    main { max-width:900px; margin:30px auto; padding:20px; background:#fff; border-radius:12px; box-shadow:0 4px 14px rgba(0,0,0,0.08); }
    h2 { margin-top:0; }

    .order-item { display:flex; gap:12px; margin-bottom:12px; padding-bottom:12px; border-bottom:1px solid #eee; }
    .order-item img { width:60px; height:60px; object-fit:cover; border-radius:8px; }
    .order-item div { font-size:14px; }

    form .form-group { margin-bottom:15px; }
    label { display:block; margin-bottom:6px; font-weight:600; }
    input, select { width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; }
    .payment-options { display:flex; gap:15px; flex-wrap:wrap; }
    .payment-options label { font-weight:normal; }

    .btn { padding:12px 20px; border:none; border-radius:30px; cursor:pointer; font-size:1rem; font-weight:600; }
    .btn.primary { background:#ff8800; color:#fff; }
    .btn.primary:hover { background:#e67600; }
    .btn.secondary { background:#f0f0f0; }

    .footer { background:#222; color:#ddd; margin-top:40px; text-align:center; padding:20px; }
    .footer p { margin:5px 0; }

    /* Modal */
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:2000; }
    .modal-content { background:#fff; padding:20px; border-radius:12px; max-width:400px; text-align:center; }
    .modal-content h3 { margin-top:0; }
    .modal-content .btn { margin:8px 0; width:100%; }
  </style>
</head>
<body>

<header class="site-header">
  <div class="container">
    <div class="logo"><a href="index.html"><img src="assets/images/ladoshalogo.png" alt="La Dosha Hotel Logo"/></a></div>
    <nav class="main-nav" id="navMenu">
      <a href="index.html">Home</a>
      <a href="menu.html">Menu</a>
      <a href="explore.html">Explore</a>
      <a href="about.html">About</a>
      <a href="destinations.html">Destination</a>
    </nav>
    <button class="menu-toggle" aria-label="Toggle menu"><span></span><span></span><span></span></button>
  </div>
</header>

<main>
  <h2>Checkout</h2>
  <div id="order-summary"></div>

  <form id="checkout-form">
    <div class="form-group">
      <label for="cust-name">Full Name *</label>
      <input type="text" id="cust-name" required>
    </div>
    <div class="form-group">
      <label for="cust-phone">Phone Number *</label>
      <input type="tel" id="cust-phone" required>
    </div>
    <div class="form-group">
      <label for="cust-email">Email</label>
      <input type="email" id="cust-email">
    </div>
    <div class="form-group">
      <label>Delivery Location *</label>
      <select id="cust-location" required onchange="toggleCustomLocation(this.value)">
        <option value="">-- Select Location --</option>
        <option>SAMCOM PROPERTIES AGENCY</option>
        <option>WESTRN STEELMART</option>
        <option>Pema Electronics</option>
        <option>Beulah Hotel</option>
        <option value="other">Other (Specify)</option>
      </select>
      <input type="text" id="custom-location" placeholder="Enter custom location" style="display:none;margin-top:8px;">
    </div>
    <div class="form-group">
      <label>Payment Method *</label>
      <div class="payment-options">
        <label><input type="radio" name="payment" value="mpesa" required> M-Pesa</label>
        <label><input type="radio" name="payment" value="cash"> Cash on Delivery</label>
      </div>
    </div>
    <button class="btn primary" type="submit">Order Now</button>
  </form>

  <div id="checkout-result"></div>
</main>

<footer class="footer">
  <p>&copy; 2025 La Dosha Hotel. All Rights Reserved.</p>
  <p>You Order We Deliver</p>
</footer>

<!-- Order Modal -->
<div id="orderModal" class="modal">
  <div class="modal-content">
    <h3>Send Your Order</h3>
    <button class="btn primary btn-wa">WhatsApp</button>
    <button class="btn secondary btn-sms">SMS</button>
    <button class="btn secondary btn-email">Email</button>
    <button class="btn secondary btn-cancel">Cancel</button>
  </div>
</div>

<script>
const menuToggle=document.querySelector('.menu-toggle');
const navMenu=document.getElementById('navMenu');
menuToggle.addEventListener('click',()=>navMenu.classList.toggle('active'));

function toggleCustomLocation(value){
  document.getElementById("custom-location").style.display=(value==="other")?"block":"none";
}

function getCartItems(){ return JSON.parse(localStorage.getItem('cart'))||[]; }
function getCartTotal(){ 
  return getCartItems().reduce((sum,it)=>sum+(it.price*it.qty),0).toFixed(2);
}

function renderCheckoutSummary(){
  const items=getCartItems();
  const summary=document.getElementById("order-summary");
  if(items.length===0){ summary.innerHTML="<p>Your cart is empty.</p>"; return; }
  let html="<h3>Your Order</h3>";
  items.forEach(it=>{
    html+=`
      <div class="order-item">
        <img src="${it.img}" alt="${it.name}">
        <div>
          <strong>${it.name}</strong><br>
          Qty: ${it.qty} Ã— KES ${it.price}<br>
          ${it.instruction ? `<em>Note: ${it.instruction}</em><br>` : ""}
          <strong>KES ${(it.qty*it.price).toFixed(2)}</strong>
        </div>
      </div>
    `;
  });
  html+=`<p><strong>Total: KES ${getCartTotal()}</strong></p>`;
  summary.innerHTML=html;
}

// Refresh checkout if cart changes in another tab/page
window.addEventListener("storage",(e)=>{ 
  if(e.key==="cart"){ renderCheckoutSummary(); }
});

document.getElementById("checkout-form").addEventListener("submit",function(e){
  e.preventDefault();
  const name=document.getElementById('cust-name').value.trim();
  const phone=document.getElementById('cust-phone').value.trim();
  const email=document.getElementById('cust-email').value.trim();
  let location=document.getElementById('cust-location').value;
  if(location==="other"){ location=document.getElementById('custom-location').value.trim(); }
  const payment=document.querySelector('input[name="payment"]:checked').value;

  const items=getCartItems();
  const total=getCartTotal();
  const orderTime=new Date().toLocaleString();

  let message=`New Order - La Dosha Hotel%0A`;
  message+=`Name: ${name}%0A`;
  message+=`Phone: ${phone}%0A`;
  if(email) message+=`Email: ${email}%0A`;
  message+=`Location: ${location}%0A`;
  message+=`Payment: ${payment}%0A`;
  message+=`Time: ${orderTime}%0A`;
  message+=`Total: KES ${total}%0AItems:%0A`;
  items.forEach(it=>{
    message+=`- ${it.name} x${it.qty} (KES ${it.qty*it.price})`;
    if(it.instruction) message+=` | Note: ${it.instruction}`;
    message+=`%0A`;
  });

  const orderModal=document.getElementById('orderModal');
  orderModal.style.display="flex";
  orderModal.querySelector('.btn-email').onclick=()=>{ window.location.href=`mailto:ladoshahotel@gmail.com?subject=New Order&body=${message}`; orderModal.style.display="none"; };
  orderModal.querySelector('.btn-sms').onclick=()=>{ window.location.href=`sms:+254715665770?body=${message}`; orderModal.style.display="none"; };
  orderModal.querySelector('.btn-wa').onclick=()=>{ window.open(`https://wa.me/254715665770?text=${message}`,'_blank'); orderModal.style.display="none"; };
  orderModal.querySelector('.btn-cancel').onclick=()=>orderModal.style.display="none";

  document.getElementById('checkout-result').innerHTML=`
    <div class="card">
      <h3>ðŸŽ‰ Thank you, ${name}!</h3>
      <p>Your order total is <strong>KES ${total}</strong>.</p>
      <p>Payment Method: <strong>${payment.toUpperCase()}</strong></p>
      <p>Weâ€™ll contact you at <strong>${phone}</strong> to deliver to <strong>${location}</strong>.</p>
      <a href="index.html" class="btn secondary">Go Home</a>
    </div>`;
  localStorage.removeItem('cart');
  renderCheckoutSummary(); // clear summary after placing order
});

document.addEventListener("DOMContentLoaded",renderCheckoutSummary);
</script>

</body>
</html>
